---
title: "DIANE - Differential Expression Analysis report"
output: 
  html_document:
    theme: flatly
    highlight: tango
    code_folding: hide
    df_print: paged
params:
  r_dea: NA
  input: NA
---
  
```{r, include=FALSE}
r <- params$r_dea
library(knitr)
```


# Dashboard for the Inference and Analysis of Networks from Expression data <img src="favicon.ico" align="right" alt="" width="120" />

---
  
This report was automatically generated by [DIANE](https://oceanecsn.github.io/DIANE) to improve research reproducibility.

It contains the main settings and results for the DEA tab of the application, and the last contrast that was tested.


# Your settings

Reference and perturbation condition :
```{r}
paste(r$ref, r$trt)
```


Threshold adjusted p-value and minimal expected abolute log fold change :
```{r}
paste("FDR =", r$fdr, "LFC = ", r$lfc)
```


# Results


Dispersion estimation :
```{r}
r$fit
```

DEGs :
```{r}
knitr::kable(head(r$gene_table), n = 40)
```

Number of upregulated genes :
```{r}
nrow(r$gene_table[r$gene_table$Regulation == "Up",])
```

Number of downregulated genes :
```{r}
nrow(r$gene_table[r$gene_table$Regulation == "Down",])
```


# Plots

```{r, fig.width=10, fig.height=8}
draw_DEGs(r$tags, fdr = r$fdr, lfc = r$lfc, MA = TRUE)
draw_DEGs(r$tags, fdr = r$fdr, lfc = r$lfc, MA = FALSE)
```

## GO enrichment analysis

```{r viz_filter, fig.width=10, fig.height=10}

knitr::kable(r$go[,c("Description", "GeneRatio", "BgRatio", "p.adjust")])
draw_enrich_go(r$go)
draw_enrich_go_map(r$go)


```
